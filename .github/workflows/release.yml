name: Release

on:
  push:
    tags: ['v*.*.*']
  workflow_dispatch:
    inputs:
      environment:
        required: true
        type: choice
        options: [staging, production]
        default: staging
      dry-run:
        required: false
        type: boolean
        default: false

jobs:
  release:
    uses: mgmacri/OP_Client-Companion-Governance/.github/workflows/release.yml@3ab99a629a8cda1a1bf740bfb89827afc4047547
    with:
      environment: ${{ inputs.environment || 'staging' }}
      dry-run: ${{ inputs.dry-run || false }}
      node-version: "20"
      pnpm-version: "9"
      working-directory: "app/client-companion"
    permissions:
      id-token: write
      contents: write
      packages: write
      attestations: write